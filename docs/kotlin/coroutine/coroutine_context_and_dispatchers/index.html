<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<title data-react-helmet="true">Coroutine context and dispatchers | COV</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://hscodev.github.io/docs/kotlin/coroutine/coroutine_context_and_dispatchers"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Coroutine context and dispatchers | COV"><meta data-react-helmet="true" name="description" content="ì½”ë£¨í‹´ì€ ì—¬ëŸ¬ ìœ í˜•ë“¤ì´ CoroutineContextê°€ ìˆìœ¼ë©°, ì´ê²ƒì´ ì œê³µí•˜ëŠ” contextì—ì„œ ì‹¤í–‰ ë©ë‹ˆë‹¤."><meta data-react-helmet="true" property="og:description" content="ì½”ë£¨í‹´ì€ ì—¬ëŸ¬ ìœ í˜•ë“¤ì´ CoroutineContextê°€ ìˆìœ¼ë©°, ì´ê²ƒì´ ì œê³µí•˜ëŠ” contextì—ì„œ ì‹¤í–‰ ë©ë‹ˆë‹¤."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hscodev.github.io/docs/kotlin/coroutine/coroutine_context_and_dispatchers"><link data-react-helmet="true" rel="alternate" href="https://hscodev.github.io/docs/kotlin/coroutine/coroutine_context_and_dispatchers" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://hscodev.github.io/docs/kotlin/coroutine/coroutine_context_and_dispatchers" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.4d477d3e.css">
<link rel="preload" href="/assets/js/runtime~main.83ea7414.js" as="script">
<link rel="preload" href="/assets/js/main.e2d59c23.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">COV</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/">Kotlin</a><a class="navbar__item navbar__link" href="/docs/etc/start_blog">ETC</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hscodev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ğŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ğŸŒ</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Index</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/kotlin/release/kotlin_1.6">Kotlin ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/docs/kotlin/coroutine/coroutine_context_and_dispatchers">Coroutine</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/kotlin/coroutine/coroutine_context_and_dispatchers">Coroutine context and dispatchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/kotlin/coroutine/asyncronous_flow">Asynchronous Flow</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_2rXS"><div class="docItemContainer_1EXp"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_Ftrd"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Coroutine context and dispatchers</h1></header><p>ì½”ë£¨í‹´ì€ ì—¬ëŸ¬ ìœ í˜•ë“¤ì´ CoroutineContextê°€ ìˆìœ¼ë©°, ì´ê²ƒì´ ì œê³µí•˜ëŠ” contextì—ì„œ ì‹¤í–‰ ë©ë‹ˆë‹¤.</p><p>contextëŠ” ì—¬ëŸ¬ ìš”ì†Œì˜ ì§‘í•©ì¸ë°, ì£¼ ìš”ì†ŒëŠ” ì½”ë£¨í‹´ì˜ Jobê³¼ Dispatcherê°€ ìˆìŠµë‹ˆë‹¤.</p><br><h2 class="anchor anchorWithStickyNavbar_31ik" id="dispatchers-and-threads"><strong>Dispatchers and threads</strong><a aria-hidden="true" class="hash-link" href="#dispatchers-and-threads" title="Direct link to heading">â€‹</a></h2><p>ì½”ë£¨í‹´ ë””ìŠ¤íŒ¨ì²˜ëŠ” ì½”ë£¨í‹´ ì‹¤í–‰ì„ íŠ¹ì • ìŠ¤ë ˆë“œë¡œ ì œí•œí•˜ê±°ë‚˜ ìŠ¤ë ˆë“œ í’€ì— ë””ìŠ¤íŒ¨ì¹˜í•˜ê±°ë‚˜ ì œí•œ ì—†ì´ ì‹¤í–‰ë˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><code>launch</code> ë° <code>async</code>ì™€ ê°™ì€ ëª¨ë“  ì½”ë£¨í‹´ ë¹Œë”ëŠ” ìƒˆ ì½”ë£¨í‹´ ë° ê¸°íƒ€ ì»¨í…ìŠ¤íŠ¸ ìš”ì†Œì— ëŒ€í•œ ë””ìŠ¤íŒ¨ì²˜ë¥¼ ì§€ì •í•˜ëŠ”  CoroutineContext ë§¤ê°œë³€ìˆ˜ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">launch { // context of the parent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;main runBlocking      : I&#x27;m working in thread ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">launch(Dispatchers.Unconfined) { // not confined -- will work with main thread</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;Unconfined            : I&#x27;m working in thread ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">launch(Dispatchers.Default) { // will get dispatched to DefaultDispatcher </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;Default               : I&#x27;m working in thread ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">launch(newSingleThreadContext(&quot;MyOwnThread&quot;)) { // will get its own new thread</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;newSingleThreadContext: I&#x27;m working in thread ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Unconfined            : I&#x27;m working in thread main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Default               : I&#x27;m working in thread DefaultDispatcher-worker-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">newSingleThreadContext: I&#x27;m working in thread MyOwnThread</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main runBlocking      : I&#x27;m working in thread main</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>launch</code>ê°€ ë§¤ê°œë³€ìˆ˜ ì—†ì´ ì‚¬ìš©ë˜ë©´ ì‹œì‘ë˜ëŠ” CoroutineScopeì˜ ì»¨í…ìŠ¤íŠ¸(ë””ìŠ¤íŒ¨ì²˜)ë¥¼ ìƒì†í•©ë‹ˆë‹¤.</p><p><a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-dispatchers/-unconfined.html" target="_blank" rel="noopener noreferrer"><code>Dispatchers.Unconfined</code></a>ëŠ” ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œë„ ì‹¤í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ ì‹¤ì œë¡œëŠ” íŠ¹ìˆ˜í•œ ë””ìŠ¤íŒ¨ì²˜ë¡œì„œ ë’¤ì— ì„¤ëª…ë©ë‹ˆë‹¤.</p><p><a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-dispatchers/-default.html" target="_blank" rel="noopener noreferrer"><code>Dispatchers.Default</code></a>ëŠ” ìŠ¤ì½”í”„ì— ëª…í™•íˆ ì„ ì–¸ í•  ë””ìŠ¤íŒ¨ì²˜ê°€ ì—†ì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ê²ƒì€ ê³µìœ  ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><p><a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/new-single-thread-context.html" target="_blank" rel="noopener noreferrer"><code>newSingleThreadContext</code></a>ëŠ” ì½”ë£¨í‹´ì´ ì‹¤í–‰í•  ìŠ¤ë ˆë“œë¥¼ ê°œë³„ì ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤. ì „ìš© ìŠ¤ë ˆë“œëŠ” ë¹„ìš©ì´ í° ë¦¬ì†ŒìŠ¤ì…ë‹ˆë‹¤. ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•Šì„ ë•Œ <code>close</code> ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ í•´ì œí•˜ê±°ë‚˜ ìµœìƒìœ„ ë³€ìˆ˜ì— ì €ì¥í•˜ê³  í”„ë¡œê·¸ë¨ ì „ì²´ì—ì„œ ì¬ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.</p><p>ì´ê²ƒì€ êµ¬ì‹ APIì´ë©° <code>Executors.newSingleThreadExecutor().asCoroutineDispatcher()</code>ë¥¼ ì‚¬ìš©í•˜ë©° ê´€ë¦¬ë©ë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">CoroutineScope(Dispatchers.IO).launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    work1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log.e(&quot;CCOOVV&quot;, &quot;IO1 work1 called ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CoroutineScope(Dispatchers.IO).launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    work1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log.e(&quot;CCOOVV&quot;, &quot;IO2 work1 called ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CoroutineScope(Executors.newSingleThreadExecutor().asCoroutineDispatcher()).launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        work1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log.e(&quot;CCOOVV&quot;, &quot;Custom work1 called ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-06 16:43:36.570 9373-9474/ IO2 work1 called DefaultDispatcher-worker-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-06 16:43:36.574 9373-9477/ IO1 work1 called DefaultDispatcher-worker-4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-11-06 16:43:37.563 9373-9479/ Custom work1 called pool-1-thread-1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><br><h2 class="anchor anchorWithStickyNavbar_31ik" id="unconfined-vs-confined-dispatcher"><strong>Unconfined vs confined dispatcher</strong><a aria-hidden="true" class="hash-link" href="#unconfined-vs-confined-dispatcher" title="Direct link to heading">â€‹</a></h2><p><a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-dispatchers/-unconfined.html" target="_blank" rel="noopener noreferrer"><code>Dispatchers.Unconfined</code></a>ëŠ” í˜¸ì¶œí•œ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ì½”ë£¨í‹´ ë””ìŠ¤íŒ¨ì²˜ ì…ë‹ˆë‹¤. ë‹¨, ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ë§Œë‚˜ê¸° ì „ê¹Œì§€ë§Œ ë™ì‘í•©ë‹ˆë‹¤. ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ë§Œë‚˜ê³  ë³µê·€í–ˆì„ ë•ŒëŠ” ì¤‘ë‹¨ í•¨ìˆ˜ì—ì„œ ì‹¤í–‰ëœ ì“°ë ˆë“œì—ì„œ ê³„ì† ì‹¤í–‰ë©ë‹ˆë‹¤.</p><p>ì´ ë””ìŠ¤íŒ¨ì²˜ëŠ” CPU ì‹œê°„ì„ ì†Œë¹„í•˜ì§€ ì•ŠëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ íŠ¹ì • ì“°ë ˆë“œì— êµ­í•œëœ ê³µìœ  ë°ì´í„°ë¥¼ ê°±ì‹ í•˜ì§€ ì•ŠëŠ” ì½”ë£¨í‹´ì— ì í•©í•©ë‹ˆë‹¤.</p><p>ë°˜ë©´ì— ë””ìŠ¤íŒ¨ì²˜ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì™¸ë¶€ CoroutineScopeì—ì„œ ìƒì†ë©ë‹ˆë‹¤. runBlocking ì½”ë£¨í‹´ì— ëŒ€í•œ ê¸°ë³¸ ë””ìŠ¤íŒ¨ì²˜ëŠ” í˜¸ì¶œì ìŠ¤ë ˆë“œë¡œ ì œí•œë˜ë¯€ë¡œ ì´ë¥¼ ìƒì†í•˜ë©´ ì˜ˆì¸¡ ê°€ëŠ¥í•œ FIFO ìŠ¤ì¼€ì¤„ë§ìœ¼ë¡œ ì‹¤í–‰ì„ ì´ ìŠ¤ë ˆë“œë¡œ ì œí•œí•˜ëŠ” íš¨ê³¼ê°€ ìˆìŠµë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">launch(Dispatchers.Unconfined) { // not confined -- will work with main thread</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;Unconfined      : I&#x27;m working in thread ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delay(500)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;Unconfined      : After delay in thread ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">launch { // context of the parent, main runBlocking coroutine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;main runBlocking: I&#x27;m working in thread ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delay(1000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;main runBlocking: After delay in thread ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Unconfined      : I&#x27;m working in thread main @coroutine#2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main runBlocking: I&#x27;m working in thread main @coroutine#3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unconfined      : After delay in thread kotlinx.coroutines.DefaultExecutor @coroutine#2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main runBlocking: After delay in thread main @coroutine#3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>ë¹„ì œí•œ ë””ìŠ¤íŒ¨ì²˜ëŠ” ì¼ë¶€ ì‘ì—…ì´ ì¦‰ì‹œ ìˆ˜í–‰ë˜ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë‚˜ì¤‘ì— ì‹¤í–‰ì„ ìœ„í•´ ì½”ë£¨í‹´ì„ ë””ìŠ¤íŒ¨ì¹˜í•  í•„ìš”ê°€ ì—†ê±°ë‚˜ ì‚¬ì´ë“œ ì´í™íŠ¸ê°€ ë°œìƒí•˜ëŠ” íŠ¹ì • ì¼€ì´ìŠ¤ì— ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ê³ ê¸‰ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. ë¹„ì œí•œ ë””ìŠ¤íŒ¨ì²˜ëŠ” ì¼ë°˜ ì½”ë“œì—ì„œ ì‚¬ìš©í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤.</strong></p><br><h2 class="anchor anchorWithStickyNavbar_31ik" id="jumping-between-threads"><strong>Jumping between threads</strong><a aria-hidden="true" class="hash-link" href="#jumping-between-threads" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">newSingleThreadContext(&quot;Ctx1&quot;).use { ctx1 -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    newSingleThreadContext(&quot;Ctx2&quot;).use { ctx2 -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        runBlocking(ctx1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log(&quot;Started in ctx1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            withContext(ctx2) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                log(&quot;Working in ctx2&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log(&quot;Back to ctx1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">[Ctx1 @coroutine#1] Started in ctx1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Ctx2 @coroutine#1] Working in ctx2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Ctx1 @coroutine#1] Back to ctx1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ìœ„ì—ëŠ” ëª‡ê°€ì§€ ê¸°ìˆ ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. í•˜ë‚˜ëŠ” ëª…ì‹œì ìœ¼ë¡œ ì§€ì •ëœ ì»¨í…ìŠ¤íŠ¸ì™€ í•¨ê»˜ runBlockingì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ì•„ë˜ ì¶œë ¥ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ ë™ì¼í•œ ì½”ë£¨í‹´ì— ê³„ì† ìœ ì§€í•˜ë©´ì„œ withContext í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë£¨í‹´ì˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p><br><h2 class="anchor anchorWithStickyNavbar_31ik" id="job-in-the-context"><strong>Job in the context</strong><a aria-hidden="true" class="hash-link" href="#job-in-the-context" title="Direct link to heading">â€‹</a></h2><p>ì½”ë£¨í‹´ì˜ <code>Job</code>ì€ contextì˜ ì¼ë¶€ì´ê³ , ë‹¤ìŒê³¼ ê°™ì´ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><code>coroutineContext[Job]</code></p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fun main() = runBlocking{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val job = CoroutineScope(Dispatchers.Unconfined).launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        delay(10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;My job is &quot; + coroutineContext[job.key])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    delay(1000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">My job is &quot;coroutine#1&quot;:BlockingCoroutine{Active}@32a1bec0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><br><h2 class="anchor anchorWithStickyNavbar_31ik" id="children-of-a-coroutine"><strong>Children of a coroutine</strong><a aria-hidden="true" class="hash-link" href="#children-of-a-coroutine" title="Direct link to heading">â€‹</a></h2><p>ë‹¤ë¥¸ ì½”ë£¨í‹´ì˜ ìŠ¤ì½”í”„ ì•ˆì—ì„œ ì½”ë£¨í‹´ì´ ì‹¤í–‰ë˜ë©´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¬¼ë ¤ë°›ê³  ìƒˆë¡œìš´ ì½”ë£¨í‹´ì˜ ì¡ì€ ë¶€ëª¨ ì½”ë£¨í‹´ì˜ ì¡ì˜ ìì‹ìœ¼ë¡œ ì‹œì‘ë©ë‹ˆë‹¤. ë¶€ëª¨ ì½”ë£¨í‹´ì´ ì·¨ì†Œë˜ë©´ ëª¨ë‘” ìì‹ë“¤ë„ ì·¨ì†Œë©ë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">val scope = CoroutineScope(Dispatchers.IO)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val parentJob = scope.launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;parent start&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val childJob = launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println(&quot;child start&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ê·¸ëŸ¬ë‚˜ ë¶€ëª¨-ìì‹ ê´€ê³„ëŠ” ë‹¤ìŒ ë‘ê°€ì§€ ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ ì¬ì •ì˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><ol><li><p>ì½”ë£¨í‹´ì„ ì‹œì‘í•  ë•Œ ë‹¤ë¥¸ ìŠ¤ì½”í”„ë¡œ ì‹¤í–‰ë˜ë©´(ì˜ˆ: GlobalScope.launch) ìƒìœ„ ìŠ¤ì½”í”„ì—ì„œ Jobì„ ìƒì†í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">val scope = CoroutineScope(Dispatchers.IO)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val parentJob = scope.launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;parent start&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val isNotChildJob = CoroutineScope(Dispatchers.IO).launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println(&quot;is not child start&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>ë‹¤ë¥¸ Job ê°ì²´ê°€ ìƒˆ ì½”ë£¨í‹´ì— ëŒ€í•œ ì»¨í…ìŠ¤íŠ¸ë¡œ ì „ë‹¬ë˜ë©´ ìƒìœ„ ë²”ìœ„ì˜ Jobì„ ì¬ì •ì˜í•©ë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">val scope = CoroutineScope(Dispatchers.IO)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val parentJob = scope.launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;parent start&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val isNotChildJob = launch(Job()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println(&quot;is not child start&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ol><br><h2 class="anchor anchorWithStickyNavbar_31ik" id="parental-responsibilities"><strong>Parental responsibilities</strong><a aria-hidden="true" class="hash-link" href="#parental-responsibilities" title="Direct link to heading">â€‹</a></h2><p>ë¶€ëª¨ ì½”ë£¨í‹´ì€ í•­ìƒ ëª¨ë“  ìì‹ ì‘ì—…ì´ ì™„ë£Œë˜ê¸°ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤. ë¶€ëª¨ëŠ” ì‹œì‘í•˜ëŠ” ëª¨ë“  ìì‹ì„ ëª…ì‹œì ìœ¼ë¡œ ì¶”ì í•  í•„ìš”ê°€ ì—†ìœ¼ë©° ë§ˆì§€ë§‰ì— ìì‹ì„ ê¸°ë‹¤ë¦¬ê¸° ìœ„í•´ Job.joinì„ ì‚¬ìš©í•  í•„ìš”ë„ ì—†ìŠµë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">// launch a coroutine to process some kind of incoming request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val request = launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repeat(3) { i -&gt; // launch a few children jobs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        launch  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            delay((i + 1) * 200L) // variable delay 200ms, 400ms, 600ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            println(&quot;Coroutine $i is done&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;request: I&#x27;m done and I don&#x27;t explicitly join my children that are still active&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.join() // wait for completion of the request, including all its children</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println(&quot;Now processing of the request is complete&quot;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">request: I&#x27;m done and I don&#x27;t explicitly join my children that are still active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Coroutine 0 is done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Coroutine 1 is done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Coroutine 2 is done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Now processing of the request is complete</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><br><h2 class="anchor anchorWithStickyNavbar_31ik" id="combining-context-elements"><strong>Combining context elements</strong><a aria-hidden="true" class="hash-link" href="#combining-context-elements" title="Direct link to heading">â€‹</a></h2><p>ë•Œë•Œë¡œ ìš°ë¦¬ëŠ” ì½”ë£¨í‹´ ì»¨í…ìŠ¤íŠ¸ì˜ ì—¬ëŸ¬ ìš”ì†Œë¥¼ ì •ì˜í•  í•„ìš”ê°€ ìˆë‹¤.</p><p><code>+</code> ì˜¤í¼ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ì˜ ê°€ëŠ¥í•˜ë‹¤.</p><p>ì˜ˆë¥¼ë“¤ì–´ ì½”ë£¨í‹´ì„ ì‹¤í–‰í•  ë•Œ Dispatcherë¥¼ ì •ì˜í•˜ê³  ì½”ë£¨í‹´ì˜ ì´ë¦„ì„ ì ì˜í•˜ê³  ì‹¶ì„ ë•Œ ë‹¤ìŒê³¼ ê°™ì´ ì ìš©í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">launch(Dispatchers.Default + CoroutineName(&quot;test&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;I&#x27;m working in thread ${Thread.currentThread().name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">I&#x27;m working in thread DefaultDispatcher-worker-1 @test#2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><br><h2 class="anchor anchorWithStickyNavbar_31ik" id="coroutine-scope"><strong>Coroutine scope</strong><a aria-hidden="true" class="hash-link" href="#coroutine-scope" title="Direct link to heading">â€‹</a></h2><p>Context, children, Job ì˜ ì •ë³´ë¥¼ í•©ì³ ë´…ì‹œë‹¤. ì–´í”Œë¦¬ì¼€ì´ì…˜ì— ìˆ˜ëª… ì£¼ê¸°ê°€ ìˆëŠ” ê°ì²´ê°€ ìˆê³ , ê·¸ ê°ì²´ëŠ” ì½”ë£¨í‹´ì´ ì•„ë‹ˆë¼ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì•ˆë“œë¡œì´ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‘ì„±í•˜ê³  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³ , ì—…ë°ì´íŠ¸í•˜ê³ , ì• ë‹ˆë©”ì´ì…˜ì„ ì²˜ë¦¬í•˜ëŠ” ë“±ì˜ ë¹„ë™ê¸° ì‘ì—…ì„ í•˜ê¸° ìœ„í•´ ì•¡í‹°ë¹„í‹° ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë‹¤ì–‘í•œ ì½”ë£¨í‹´ì„ ì‹œì‘í•©ë‹ˆë‹¤. ëª¨ë“  ì½”ë£¨í‹´ì€ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì•¡í‹°ë¹„í‹°ê°€ íŒŒê´´ë˜ë©´ ëª¨ë‘ ì·¨ì†Œë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</p><p>ë¬¼ë¡  Contextì™€ Jobì„ ì§ì ‘ ì¡°ì‘í•˜ì—¬ ì•¡í‹°ë¹„í‹°ì™€ ì½”ë£¨í‹´ì˜ ìˆ˜ëª… ì£¼ê¸°ë¥¼ ì—°ê²°í•  ìˆ˜ ìˆì§€ë§Œ, kotlinx.coroutinesëŠ” CoroutineScopeë¥¼ ìº¡ìŠí™”í•˜ëŠ” ì¶”ìƒí™”ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ëª¨ë“  ì½”ë£¨í‹´ ë¹Œë”ê°€ í™•ì¥í•¨ìˆ˜ë¡œ ì„ ì–¸ë˜ë¯€ë¡œ ì½”ë£¨í‹´ ìŠ¤ì½”í”„ì— ìµìˆ™í•´ì ¸ì•¼ í•©ë‹ˆë‹¤.</p><p>ìš°ë¦¬ëŠ” ì•¡í‹°ë¹„í‹°ì˜ ìƒëª…ì£¼ê¸°ì— ì—°ê²°ëœ CoroutineScope ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ì½”ë£¨í‹´ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤. SoroutineScope ì¸ìŠ¤í„´ìŠ¤ëŠ” CoroutineScope() ë˜ëŠ” MainScope() íŒ©í† ë¦¬ í•¨ìˆ˜ë¡œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì „ìëŠ” ë²”ìš© ë²”ìœ„ë¥¼ ìƒì„±í•˜ê³  í›„ìëŠ” Dispatchers.Main ë””ìŠ¤íŒ¨ì²˜ë¥¼ ì‚¬ìš©í•˜ì—¬ UI ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ Scopeë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class Activity {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private val mainScope = MainScope()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun destroy() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mainScope.cancel()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ì •ì˜í•œ ì½”ë£¨í‹´ ìŠ¤ì½”í”„ì—ì„œ ì½”ë£¨í‹´ì„ ì‹¤í–‰ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fun doSomething() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // launch ten coroutines for a demo, each working for a different time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repeat(10) { i -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mainScope.launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            delay((i + 1) * 200L) // variable delay 200ms, 400ms, ... etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            println(&quot;Coroutine $i is done&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ì•¡í‹°ë¹„í‹°ê°€ ìƒì„±ëœ í›„ì— í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê³ , 500ms í›„ì— ì•¡í‹°ë¹„í‹°ë¥¼ íŒŒê´´í•˜ëŠ” ê²½ìš° í•¨ìˆ˜ëŠ” ì¤‘ë‹¨ë©ë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">val activity = Activity()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">activity.doSomething() // run test function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println(&quot;Launched coroutines&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delay(500L) // delay for half a second</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">println(&quot;Destroying activity!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">activity.destroy() // cancels all coroutines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delay(1000) // visually confirm that they don&#x27;t work</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Launched coroutines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Coroutine 0 is done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Coroutine 1 is done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Destroying activity!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ì•ˆë“œë¡œì´ë“œì—ì„œëŠ” first-partyë¡œ ìƒëª…ì£¼ê¸°ì— ëŒ€í•œ ì½”ë£¨í‹´ ìŠ¤ì½”í”„ë¥¼ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p><p><a href="https://developer.android.com/topic/libraries/architecture/coroutines#lifecyclescope" target="_blank" rel="noopener noreferrer">https://developer.android.com/topic/libraries/architecture/coroutines#lifecyclescope</a></p><br><h3 class="anchor anchorWithStickyNavbar_31ik" id="thread-local-data"><strong>Thread-local data</strong><a aria-hidden="true" class="hash-link" href="#thread-local-data" title="Direct link to heading">â€‹</a></h3><p>ì½”ë£¨í‹´ê°„ì— í˜¹ì€ ìŠ¤ë ˆë“œ ë¡œì»¬ê°„ì— ë°ì´í„°ë¥¼ ê°„í¸í•˜ê²Œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ê·¸ëŸ¬ë‚˜ íŠ¹ì • ìŠ¤ë ˆë“œì— ë°”ì¸ë”©ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ìˆ˜ë™ìœ¼ë¡œ ìˆ˜í–‰í•˜ë©´ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ì´ë¥¼ ìœ„í•´ ThreadLocalì€ asContextElement í™•ì¥ í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤. ì£¼ì–´ì§„ ThreadLocalì˜ ê°’ì„ ìœ ì§€í•˜ê³  ì½”ë£¨í‹´ì´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì „í™˜í•  ë•Œë§ˆë‹¤ ì´ë¥¼ ë³µì›í•˜ëŠ” ì¶”ê°€ ì»¨í…ìŠ¤íŠ¸ ìš”ì†Œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fun main() = runBlocking {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val threadLocal = ThreadLocal&lt;String&gt;()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    threadLocal.set(&quot;main&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;Pre-main, current thread: ${Thread.currentThread()}, thread local value: &#x27;${threadLocal.get()}&#x27;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val job = launch(Dispatchers.Default + threadLocal.asContextElement(value = &quot;launch&quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println(&quot;Launch start, current thread: ${Thread.currentThread()}, thread local value: &#x27;${threadLocal.get()}&#x27;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        yield()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println(&quot;After yield, current thread: ${Thread.currentThread()}, thread local value: &#x27;${threadLocal.get()}&#x27;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    job.join()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    println(&quot;Post-main, current thread: ${Thread.currentThread()}, thread local value: &#x27;${threadLocal.get()}&#x27;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-kotlin"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Pre-main, current thread: Thread[main @coroutine#1,5,main], thread local value: &#x27;main&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Launch start, current thread: Thread[DefaultDispatcher-worker-1 @coroutine#2,5,main], thread local value: &#x27;launch&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">After yield, current thread: Thread[DefaultDispatcher-worker-1 @coroutine#2,5,main], thread local value: &#x27;launch&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Post-main, current thread: Thread[main @coroutine#1,5,main], thread local value: &#x27;main&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ìœ„ ì˜ˆì œì—ì„œëŠ” ìƒˆë¡œìš´ ì½”ë£¨í‹´ì„ Dispatcher.Defaultì˜ ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œ í’€ì„ ì‚¬ìš©í•˜ì˜€ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ ë™ì‘í•˜ì˜€ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì½”ë£¨í‹´ì´ ì‹¤í–‰ë˜ëŠ” ìŠ¤ë ˆë“œì— ê´€ê³„ì—†ì´ <code>threadLocal.asContextElement(value = &quot;launch&quot;)</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ thread local ë³€ìˆ˜ëŠ” ì—¬ì „íˆ ì¡´ì¬í•©ë‹ˆë‹¤.</p><p>ì´ ì»¨í…ìŠ¤íŠ¸ ìš”ì†Œë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì„ ìŠí˜€ì§€ê¸° ì‰½ìŠµë‹ˆë‹¤. ì½”ë£¨í‹´ì„ ì‹¤í–‰í•˜ëŠ” ìŠ¤ë ˆë“œê°€ ë‹¤ë¥¸ ê²½ìš° ì•¡ì„¸ìŠ¤í•˜ëŠ” ìŠ¤ë ˆë“œ ë¡œì»¬ ë³€ìˆ˜ì— ì˜ˆê¸°ì¹˜ ì•Šì€ ê°’ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒí™©ì„ í”¼í•˜ë ¤ë©´ surePresent ë©”ì„œë“œì™€ fail-fastë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.</p><p>ThreadLocalì€ ìµœê³  ìˆ˜ì¤€ì˜ ì§€ì›ì„ ì œê³µí•˜ë©° ëª¨ë“  ê¸°ë³¸ kotlinx.coroutinesê°€ ì œê³µí•˜ëŠ” ê²ƒê³¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í•œ ê°€ì§€ ì£¼ìš” ì œí•œ ì‚¬í•­ì´ ìˆìŠµë‹ˆë‹¤. ìŠ¤ë ˆë“œ ë¡œì»¬ì´ ë³€ê²½ë˜ë©´ ìƒˆ ê°’ì´ ì½”ë£¨í‹´ í˜¸ì¶œìì—ê²Œ ì „íŒŒë˜ì§€ ì•Šê³  ì—…ë°ì´íŠ¸ëœ ê°’ì´ ë‹¤ìŒ ì¼ì‹œ ì¤‘ë‹¨ ì‹œ ì†ì‹¤ë©ë‹ˆë‹¤.(ì»¨í…ìŠ¤íŠ¸ ìš”ì†Œê°€ ëª¨ë“  ThreadLocal ê°œì²´ ì•¡ì„¸ìŠ¤ë¥¼ ì¶”ì í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—)</p><p>withContextë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë£¨í‹´ì—ì„œ ìŠ¤ë ˆë“œ ë¡œì»¬ ê°’ì„ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”. ìì„¸í•œ ë‚´ìš©ì€ asContextElementë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.</p><p>ë˜ëŠ” Counter(var i: Int) í´ë˜ìŠ¤ì™€ ê°™ì€ mutable boxì— ê°’ì„ ì €ì¥í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì°¨ë¡€ë¡œ ìŠ¤ë ˆë“œ ë¡œì»¬ ë³€ìˆ˜ì— ì €ì¥ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ê²½ìš° mutable boxì— ëŒ€í•œ ì ì¬ì ì¸ ë™ì‹œì„± ë¬¸ì œì— ëŒ€í•´ì„œëŠ” ê°œë³„ì ì¸ ì²˜ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p><p>ë‹¤ìŒê³¼ ê°™ì€ ê³ ê¸‰ ì‚¬ìš©ë²•ìœ¼ë¡œì„œëŠ” êµ¬í˜„í•´ì•¼ í•˜ëŠ” ThreadContextElement ì¸í„°í˜ì´ìŠ¤ì˜ ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤. (ë¡œê¹… MDC, íŠ¸ëœì­ì…˜ ì»¨í…ìŠ¤íŠ¸, ë°ì´í„° ì „ë‹¬ì„ ìœ„í•´ ë‚´ë¶€ì ìœ¼ë¡œ ìŠ¤ë ˆë“œ ë¡œì»¬ì„ ì‚¬ìš©í•˜ëŠ” ê¸°íƒ€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ì˜ í†µí•©)</p></div></article><div class="comment-container"></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dispatchers-and-threads" class="table-of-contents__link toc-highlight"><strong>Dispatchers and threads</strong></a></li><li><a href="#unconfined-vs-confined-dispatcher" class="table-of-contents__link toc-highlight"><strong>Unconfined vs confined dispatcher</strong></a></li><li><a href="#jumping-between-threads" class="table-of-contents__link toc-highlight"><strong>Jumping between threads</strong></a></li><li><a href="#job-in-the-context" class="table-of-contents__link toc-highlight"><strong>Job in the context</strong></a></li><li><a href="#children-of-a-coroutine" class="table-of-contents__link toc-highlight"><strong>Children of a coroutine</strong></a></li><li><a href="#parental-responsibilities" class="table-of-contents__link toc-highlight"><strong>Parental responsibilities</strong></a></li><li><a href="#combining-context-elements" class="table-of-contents__link toc-highlight"><strong>Combining context elements</strong></a></li><li><a href="#coroutine-scope" class="table-of-contents__link toc-highlight"><strong>Coroutine scope</strong></a><ul><li><a href="#thread-local-data" class="table-of-contents__link toc-highlight"><strong>Thread-local data</strong></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/hscodev" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 COV. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.83ea7414.js"></script>
<script src="/assets/js/main.e2d59c23.js"></script>
</body>
</html>